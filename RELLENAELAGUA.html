<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Water Sort Puzzle</title>
	<link href="https://fonts.googleapis.com/css2?family=Smooch+Sans:wght@400;700&display=swap" rel="stylesheet">
	<style>
	#startScreen {
	position: absolute;
	top: 0;
	left: 0;
	width: 100vw;
	height: 100vh;
	background: rgba(0,0,0,0.9);
	color: white;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	text-align: center;
	z-index: 20;
	}
	#startScreen button {
	margin-top: 40px;
	padding: 15px 30px;
	font-size: 2em;
	background: #ff7043;
	color: white;
	border: none;
	border-radius: 30px;
	cursor: pointer;
	transition: background 0.3s, transform 0.3s;
	}
	#startScreen button:hover {
	background: #ff5722;
	transform: translateY(-5px);
	}
	:root {
	--bg-color: #6a4a4a;
	--bg-color-end: #38212a;
	--main-font: 'Smooch Sans', sans-serif;
	--flask-border: #ffe0b2;
	--flask-bg: rgba(255, 255, 255, 0.05);
	--selected-border: #ffc107;
	--button-bg: #ff7043;
	--button-hover: #ff5722;
	--glass-gradient-color1: rgba(255,255,255,0.3);
	--glass-gradient-color2: rgba(255,255,255,0.15);
	}
	body {
	margin: 0;
	font-family: var(--main-font);
	background: linear-gradient(135deg, var(--bg-color), var(--bg-color-end));
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	min-height: 100vh;
	color: white;
	text-align: center;
	overflow: hidden;
	font-family: Smooch Sans;
	font-size: 25px;
	}
	h1 { 
	margin-top: 20px; 
	font-size: 2.5rem; 
	}
	#game {
	display: flex;
	flex-wrap: wrap;
	justify-content: center;
	gap: 20px;
	margin: 40px auto;
	max-width: 90%;
	}
	.frascos {
	position: relative;
	width: 70px;
	height: 250px;
	border: 4px solid var(--flask-border);
	border-radius: 0 0 35px 35px;
	background: var(--flask-bg);
	display: flex;
	flex-direction: column-reverse;
	justify-content: flex-start;
	overflow: hidden;
	cursor: pointer;
	transition: 0.2s;
	}
	.frascos:hover { transform: translateY(-5px); }
	.frascos.selected {
	border-color: var(--selected-border);
	transform: scale(1.05) translateY(-10px);
	box-shadow: 0 0 20px #ffc107aa;
	}
	.agua {
	width: 100%;
	height: 62.5px;
	transition: 0.5s;
	}
	.frascos::before, .frascos::after {
	content: '';
	position: absolute;
	width: 100%;
	height: 100%;
	left: 0;
	border-radius: 0 0 35px 35px;
	}
	.frascos::before { top: 0; box-shadow: inset 0 0 20px rgba(255,255,255,0.2); z-index: 1; }
	.frascos::after {
	top: 0;
	background: linear-gradient(to top, transparent 50%, var(--glass-gradient-color1) 80%, var(--glass-gradient-color2) 90%);
	z-index: 2;
	opacity: 0.8;
	}
	#info { font-size: 1.2rem; margin: 20px; }
	.boton {
	padding: 10px 20px;
	background: var(--button-bg);
	color: white;
	border: none;
	border-radius: 20px;
	cursor: pointer;
	font-size: 1rem;
	transition: 0.3s;
	}
	.boton:hover { background: var(--button-hover); transform: translateY(-3px); }
	.win-message, .lose-message {
	position: fixed;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	padding: 25px 40px;
	border-radius: 15px;
	font-size: 2rem;
	font-weight: bold;
	z-index: 1000;
	text-shadow: 2px 2px 5px black;
	animation: fadeIn 0.5s ease-out;
	}
	.win-message { background: rgba(76,175,80,0.9); box-shadow: 0 0 20px rgba(76,175,80,0.8); }
	.lose-message { background: rgba(244,67,54,0.9); box-shadow: 0 0 20px rgba(244,67,54,0.8); }
	@keyframes fadeIn {
	from { opacity: 0; transform: translate(-50%, -60%); }
	to { opacity: 1; transform: translate(-50%, -50%); }
	}
</style>
</head>
<body>
	<div id="startScreen">
	<h1>Puzzle de Agua</h1>
	<p>¡Bienvenido al Puzzle de agua! El objetivo del juego es simple:</p>
	<p><strong>Clasifica el agua de colores en los tubos</strong> hasta que cada frasco contenga un solo color.</p>
	<p>Para jugar, **toca un frasco para seleccionarlo** y luego **toca otro frasco para verter el agua**.</p>
	<p>Recuerda que solo puedes verter agua sobre el mismo color o en un frasco vacío.</p>
	<button class="boton" onclick="startGame()">¡Comenzar!</button>
	</div>
	<h1>Puzzle de agua - Nivel <span id="nivel">1</span></h1>
	<div id="info"></div>
	<div id="game"></div>
	<button class="boton" onclick="reiniciarNivel()">Reiniciar Nivel</button>
	<script>
	function startGame() {
	document.getElementById('startScreen').style.display = 'none';
	crearNivel();
	}
	const niveles = [
	{ frascos: 5, colores: ["#ff4081", "#00e5ff", "#ffee00", "#00e676"] },
	{ frascos: 7, colores: ["#ff4081", "#00e5ff", "#ffee00", "#00e676", "#d500f9", "#ff9100"] },
	{ frascos: 9, colores: ["#ff4081", "#00e5ff", "#ffee00", "#00e676", "#d500f9", "#ff9100", "#ff1744", "#651fff"] }
	];
	let nivelActual = 0, seleccion = null, isAnimating = false;
	function crearNivel() {
	const cont = document.getElementById("game");
	cont.innerHTML = "";
	document.getElementById("nivel").innerText = nivelActual + 1;
	const { frascos, colores } = niveles[nivelActual];
	let contenido = [];
	colores.forEach(c => { for (let i = 0; i < 4; i++) contenido.push(c); });
	contenido = contenido.sort(() => Math.random() - 0.5);
	let lista = [];
	for (let i = 0; i < colores.length; i++) lista.push(contenido.splice(0, 4));
	for (let i = 0; i < frascos - colores.length; i++) lista.push([]);
	lista = lista.sort(() => Math.random() - 0.5);
	lista.forEach((col, i) => {
		const frasco = document.createElement("div");
		frasco.className = "frascos";
		frasco.dataset.index = i;
		frasco.onclick = () => seleccionar(frasco);
		col.forEach(c => {
		const agua = document.createElement("div");
		agua.className = "agua";
		agua.style.background = c;
		frasco.appendChild(agua);
		});
	cont.appendChild(frasco);
	});
	}
	function seleccionar(f) {
	if (isAnimating) return;
	if (!seleccion) {
	if (f.children.length === 0) return;
	seleccion = f;
	f.classList.add("selected");
	} else if (seleccion === f) {
	f.classList.remove("selected");
	seleccion = null;
	} else {
	transferir(seleccion, f);
	}}
	function transferir(origen, destino) {
		const oc = [...origen.children], dc = [...destino.children];
		const color = oc[oc.length - 1]?.style.background;
		const tope = dc[dc.length - 1]?.style.background;
		if (!color || dc.length === 4 || (dc.length > 0 && tope !== color)) {
		seleccion.classList.remove("selected");
		seleccion = null;
		return;
		}
		isAnimating = true;
		let count = 0;
		for (let i = oc.length - 1; i >= 0 && oc[i].style.background === color; i--) count++;
		let mover = Math.min(4 - dc.length, count);
		for (let i = 0; i < mover; i++) {
		const agua = origen.lastChild;
		origen.removeChild(agua);
		destino.appendChild(agua);
		}
		seleccion.classList.remove("selected");
		seleccion = null;
		isAnimating = false;
		setTimeout(verificarEstado, 200);
	}
	function verificarEstado() {
	const frascos = document.querySelectorAll(".frascos");
	let completos = true, movimientos = false;
	for (let f of frascos) {
	const hijos = [...f.children];
	if (hijos.length === 0) continue;
	const c = hijos[0].style.background;
	if (hijos.length !== 4 || hijos.some(h => h.style.background !== c)) completos = false;
	}
	if (completos) {
	mostrarMensaje("¡Nivel superado!");
	setTimeout(() => {
	if (nivelActual < niveles.length - 1) {
	nivelActual++;
	crearNivel();
	} else mostrarMensaje("¡Has ganado!", "win");
	}, 1500);
	return;}
	for (let o of frascos) {
	if (o.children.length === 0) continue;
	const co = o.lastChild.style.background;
	for (let d of frascos) {
	if (o === d) continue;
	const dc = [...d.children];
	const td = dc[dc.length - 1]?.style.background;
	if (dc.length < 4 && (dc.length === 0 || td === co)) movimientos = true;
	}}
		if (!movimientos) {
		mostrarMensaje("¡Sin movimientos posibles!", "lose");
		setTimeout(reiniciarNivel, 2000);
	}}
	function mostrarMensaje(texto, tipo = "win") {
	const msg = document.createElement("div");
	msg.innerText = texto;
	msg.className = tipo === "win" ? "win-message" : "lose-message";
	document.body.appendChild(msg);
	setTimeout(() => msg.remove(), 2000);
	}
	function reiniciarNivel() { crearNivel(); }
	document.addEventListener("DOMContentLoaded", () => {
	document.getElementById('startScreen').style.display = 'flex';
	});
	</script>
</body>
</html>
